{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Fix app creation failure and invisible prompt input text",
  "requirements": [
    {
      "id": "REQ-1",
      "summary": "Fix the prompt textarea input field on the BuilderPage so that typed text is clearly visible with proper contrast in all themes",
      "acceptanceCriteria": [
        "Text typed into the prompt textarea is clearly legible with sufficient contrast ratio (minimum 4.5:1) against the input background.",
        "Placeholder text is also visible (slightly muted but not invisible).",
        "The fix applies consistently in both light and dark mode if the app supports both."
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/BuilderPage.tsx",
          "operation": "modify",
          "description": "Fix the textarea input field styling to ensure typed text has proper contrast against the background. Update the className or inline styles of the textarea element to use CSS custom properties that provide sufficient text-to-background contrast in both light and dark modes. Ensure the placeholder text color is also visible but slightly muted. Reference the color tokens defined in frontend/src/index.css to maintain consistency with the design system."
        },
        {
          "path": "frontend/src/index.css",
          "operation": "modify",
          "description": "Review and adjust the CSS custom properties for input/textarea text colors if needed to ensure a minimum 4.5:1 contrast ratio against input backgrounds in both light and dark modes. Add or update color token definitions (e.g., --input-text, --input-placeholder) to ensure visibility. Verify that dark mode input backgrounds do not cause dark-on-dark text."
        }
      ]
    },
    {
      "id": "REQ-2",
      "summary": "Fix the app creation flow on the BuilderPage so that users can successfully generate and save a new creation and navigate to the creation viewer",
      "acceptanceCriteria": [
        "Selecting a creation type, entering a prompt, and clicking the generate button successfully generates a creation.",
        "The generated creation is saved to the backend and appears in the user's library.",
        "After successful creation, the user is navigated to the creation viewer page.",
        "Appropriate loading state is shown during generation and saving.",
        "Any error that occurs is surfaced to the user with a clear, readable error message."
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/BuilderPage.tsx",
          "operation": "modify",
          "description": "Fix the app creation flow by ensuring the generate button handler correctly calls the generation pipeline (via frontend/src/generation/templates.ts), saves the result using the backend's generateAppCreation and updateAppCreation methods from useQueries, handles loading and error states properly, and navigates to the creation viewer page on success using TanStack Router. Ensure error messages are displayed clearly to the user using the AsyncState component or inline error UI. Verify that the loading state is shown during both generation and saving steps."
        },
        {
          "path": "frontend/src/hooks/useQueries.ts",
          "operation": "modify",
          "description": "Review the mutations for generateAppCreation and updateAppCreation to ensure they handle errors gracefully and return clear error messages. Verify that the mutations invalidate the relevant query cache keys (e.g., 'userCreations') on success so the user's library updates immediately. Ensure authorization errors are caught and normalized using frontend/src/services/errors.ts."
        },
        {
          "path": "frontend/src/components/system/AsyncState.tsx",
          "operation": "modify",
          "description": "Ensure the AsyncState component renders error messages with sufficient contrast and readability. If the error text color is too dark or invisible, update the alert styling to use properly contrasted color tokens from the design system. This component is used in BuilderPage to display creation flow errors."
        }
      ]
    }
  ]
}