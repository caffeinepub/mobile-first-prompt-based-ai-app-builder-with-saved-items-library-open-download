{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Fix chatbot runtime — bots not responding to user messages",
  "requirements": [
    {
      "id": "REQ-1",
      "summary": "Fix the ChatbotRuntime component so that it correctly processes user messages and generates bot responses, including keyword matching, fallback responses, typing indicator, and message thread scrolling.",
      "acceptanceCriteria": [
        "Typing a message and pressing Send or Enter always produces a bot reply",
        "Keyword-matched responses return the correct configured reply",
        "A fallback/default reply is shown when no keyword matches",
        "The typing indicator appears for a short delay before the reply appears",
        "The message thread scrolls to the latest message after each exchange",
        "No JavaScript console errors are thrown during a chat interaction"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/runtime/ChatbotRuntime.tsx",
          "operation": "modify",
          "description": "Fix the bot response logic to correctly match user input against keyword triggers (case-insensitive), return the matched response, or fall back to the configured fallback response when no keyword matches. Ensure the typing indicator is displayed briefly before appending the bot's reply. Fix the message thread scrolling to always scroll to the latest message after each user-bot exchange. Handle empty or undefined responses array and fallback string gracefully. Verify that the component does not throw errors during chat interactions."
        }
      ]
    },
    {
      "id": "REQ-2",
      "summary": "Audit and fix the chatbot data generation logic in frontend/src/generation/templates.ts to ensure generated ChatbotData objects include valid, non-empty keyword–response pairs and a defined fallback response string.",
      "acceptanceCriteria": [
        "Generated chatbot data always contains at least one keyword–response entry",
        "Generated chatbot data always contains a non-empty fallback response string",
        "ChatbotRuntime can render and use the generated data without errors"
      ],
      "file_operations": [
        {
          "path": "frontend/src/generation/templates.ts",
          "operation": "modify",
          "description": "Audit the generateChatbotData function to ensure it always produces a ChatbotData object with at least one keyword–response pair in the responses array and a non-empty fallback string. Fix any logic that could result in an empty or undefined responses array or a missing/empty fallback. Ensure the generated data structure matches the shape expected by ChatbotRuntime (each response entry should have a keyword and reply field)."
        }
      ]
    },
    {
      "id": "REQ-3",
      "summary": "Audit and fix the chatbot HTML export in frontend/src/utils/exportCreationHtml.ts to ensure exported chatbot pages correctly process user input and display bot responses, matching the in-app runtime behaviour.",
      "acceptanceCriteria": [
        "Exported chatbot HTML file responds to typed messages",
        "Keyword and fallback responses work correctly in the exported file"
      ],
      "file_operations": [
        {
          "path": "frontend/src/utils/exportCreationHtml.ts",
          "operation": "modify",
          "description": "Audit the chatbot HTML export logic to ensure the embedded JavaScript correctly processes user input, matches keywords (case-insensitive), returns the appropriate response, or falls back to the default response. Fix any discrepancies between the exported runtime logic and the in-app ChatbotRuntime component. Ensure the typing indicator, message appending, and scrolling behaviour match the in-app experience. Test that the exported HTML file can handle edge cases (empty responses array, missing fallback) gracefully."
        }
      ]
    }
  ]
}